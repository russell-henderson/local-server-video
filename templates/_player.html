<!-- templates/_player.html -->
<div class="player" data-player>
  <video 
    src="{{ url_for('stream_video', filename=filename) }}" 
    playsinline
    preload="metadata"
    data-filename="{{ filename }}"
  ></video>
  
  <div class="player-controls" data-controls>
    <!-- Skip back 10 seconds -->
    <button data-action="back10" aria-label="Back 10 seconds" title="Back 10s (J)">
      âŸ²10
    </button>
    
    <!-- Play/Pause -->
    <button data-action="play" aria-label="Play/Pause" title="Play/Pause (K or Space)">
      â¯
    </button>
    
    <!-- Skip forward 10 seconds -->
    <button data-action="fwd10" aria-label="Forward 10 seconds" title="Forward 10s (L)">
      10âŸ³
    </button>
    
    <!-- Seek bar -->
    <input 
      type="range" 
      data-role="seek" 
      min="0" 
      max="100" 
      value="0" 
      aria-label="Seek"
      title="Seek timeline"
    />
    
    <!-- Time display -->
    <span class="time-display" data-time>
      <span data-current-time>0:00</span> / <span data-duration>0:00</span>
    </span>
    
    <!-- Mute button -->
    <button data-action="mute" aria-label="Mute" title="Mute (M)">
      ğŸ”‡
    </button>
    
    <!-- Volume control -->
    <input 
      type="range" 
      data-role="volume" 
      min="0" 
      max="1" 
      step="0.05" 
      value="1" 
      aria-label="Volume"
      title="Volume (â†‘/â†“)"
    />
    
    <!-- Player controls (no subtitle system) -->

    <!-- Fullscreen button -->
    <!-- Favorite toggle (also included here so it remains visible when the video element is moved into an immersive/VR container) -->
    <button class="btn btn-sm favorite-btn player-favorite-btn" data-filename="{{ filename }}" title="Toggle Favorite" aria-label="{% if filename in favorites_list %}Remove from favorites{% else %}Add to favorites{% endif %}">
      <i class="fa{% if filename in favorites_list %}s{% else %}r{% endif %} fa-heart text-danger"></i>
    </button>

    <!-- Compact rating widget placed in player controls so it remains visible in fullscreen/VR -->
    <div class="rating player-rating" data-filename="{{ filename }}" role="group" aria-label="Rate this video">
      {% set current_rating = ratings.get(filename, 0) if (ratings is defined) else 0 %}
      {% for i in range(1,6) %}
        <i class="{{ 'fas' if i<=current_rating else 'far' }} fa-star"
           data-value="{{ i }}"
           role="button"
           tabindex="0"
           aria-label="Rate {{ i }} star{% if i != 1 %}s{% endif %}"></i>
      {% endfor %}
    </div>

    <button data-action="fullscreen" aria-label="Fullscreen" title="Fullscreen (F)">
      â›¶
    </button>
  </div>
</div>