<!-- templates/_player.html -->
<div class="player" data-player>
  <video 
    src="{{ url_for('stream_video', filename=filename) }}" 
    playsinline
    preload="metadata"
    data-filename="{{ filename }}"
  ></video>
  
  <div class="player-controls" data-controls>
    <!-- Skip back 10 seconds -->
    <button data-action="back10" aria-label="Back 10 seconds" title="Back 10s (J)">
      âŸ²10
    </button>
    
    <!-- Play/Pause -->
    <button data-action="play" aria-label="Play/Pause" title="Play/Pause (K or Space)">
      â¯
    </button>
    
    <!-- Skip forward 10 seconds -->
    <button data-action="fwd10" aria-label="Forward 10 seconds" title="Forward 10s (L)">
      10âŸ³
    </button>
    
    <!-- Seek bar -->
    <input 
      type="range" 
      data-role="seek" 
      min="0" 
      max="100" 
      value="0" 
      aria-label="Seek"
      title="Seek timeline"
    />
    
    <!-- Time display -->
    <span class="time-display" data-time>
      <span data-current-time>0:00</span> / <span data-duration>0:00</span>
    </span>
    <span class="time-preview small text-muted" data-preview>Seek: 0:00</span>
    
    <!-- Mute button -->
    <button data-action="mute" aria-label="Mute" title="Mute (M)">
      ğŸ”‡
    </button>
    
    <!-- Volume control -->
    <input 
      type="range" 
      data-role="volume" 
      min="0" 
      max="1" 
      step="0.05" 
      value="1" 
      aria-label="Volume"
      title="Volume (â†‘/â†“)"
    />

    <!-- Speed controls -->
    <div class="speed-controls ms-2" aria-label="Playback speed">
      <button data-action="speed-down" title="Slow down ([)">-</button>
      <span data-speed-display title="Current speed">1.0x</span>
      <button data-action="speed-up" title="Speed up (])">+</button>
    </div>

    <!-- Loop toggle -->
    <button data-action="loop" aria-pressed="false" title="Toggle loop (B)">
      Loop
    </button>
    
    <!-- Player controls (no subtitle system) -->

    <!-- Fullscreen button -->
    <!-- Favorite toggle (also included here so it remains visible when the video element is moved into an immersive/VR container) -->
    <button class="btn btn-sm favorite-btn player-favorite-btn" data-filename="{{ filename }}" title="Toggle Favorite" aria-label="{% if filename in favorites_list %}Remove from favorites{% else %}Add to favorites{% endif %}">
      <i class="fa{% if filename in favorites_list %}s{% else %}r{% endif %} fa-heart text-danger"></i>
    </button>

    <!-- Compact rating widget placed in player controls so it remains visible in fullscreen/VR -->
    {% with current_rating=ratings.get(filename, 0) if (ratings is defined) else 0, filename=filename, media_hash=media_hash %}
      {% include 'partials/rating.html' %}
    {% endwith %}

    <button data-action="fullscreen" aria-label="Fullscreen" title="Fullscreen (F)">
      â›¶
    </button>
  </div>
</div>
